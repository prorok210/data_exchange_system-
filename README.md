# Система обмена данными на базе ESP32 с поддержкой Mesh-сети

## Описание проекта
Этот проект реализует систему обмена данными на основе технологии ESP Mesh для создания самоорганизующейся беспроводной сети устройств ESP32. Пока работает только при наличии роутера, подключенного к корневому узлу

## Возможности
- Организация mesh-сети для обмена данными
- Поддержка топологии "дерево" и "цепочка"
- Автоматическое определение роли устройства в сети (корневой узел или внутренний узел)

## Требования для сборки
- [ESP-IDF](https://docs.espressif.com/projects/esp-idf/en/latest/esp32/get-started/) v5.1 или выше (для локальной сборки)
- CMake 3.16 или выше
- Python 3.7 или выше

## Сборка и запуск

### Локальная сборка
1. Настройте окружение ESP-IDF:
   ```bash
   . $IDF_PATH/export.sh
   ```

2. Соберите проект:
   ```bash
   idf.py build
   ```

3. Прошивка на устройство:
   ```bash
   idf.py -p [PORT] flash
   ```
4. Просмотр логов 
    ```bash
   idf.py -p [PORT] monitor
   ```

### Тестовая прошивка с использованием Docker и QEMU (позволяет проверить только возможность прошить устройство, т.к нет поддержки wi-fi)
1. Соберите Docker-образ:
   ```bash
   docker build -t test_build .
   ```

2. Запустите контейнер:
   ```bash
   docker run --rm test_build
   ```
3. В случае успеха получите пододный консольный вывод
    ```bash
    ...
    I (1342) main_task: Calling app_main()
    I (1342) mesh_main: Успешная загрузка в режиме тестирования!
    I (1342) main_task: Returned from app_main()
    ```



## Настройка Mesh-сети
Для настройки Mesh-сети используются следующие параметры:
- MESH_ID: Идентификатор сети (по умолчанию 0x77, 0x77, 0x77, 0x77, 0x77, 0x77)
- CONFIG_MESH_ROUTER_SSID: SSID маршрутизатора для подключения корневого узла
- CONFIG_MESH_ROUTER_PASSWD: Пароль маршрутизатора
- CONFIG_MESH_AP_PASSWD: Пароль для точки доступа mesh-узлов

Меню настроек
   ```bash
   idf.py menuconfig
   ```
